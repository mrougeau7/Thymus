result_WT1<-toFill_WT1[,toUse1_WT1]
result_WT1->result1_WT1
}
for(i in toUse2_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse2_WT1]
result_WT1->result2_WT1
}
for(i in toUse3_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse3_WT1]
result_WT1->result3_WT1   ###Section3
}
library (vegan)
library(labdsv)
spe.kmeans_All_WT1 <- kmeans(result0_WT1, centers=cluster, nstart=1500)
spe.kmeans_S1_WT1 <- kmeans(result1_WT1, centers=cluster, nstart=1500)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1500)
spe.kmeans_S3_WT1 <- kmeans(result3_WT1, centers=cluster, nstart=1500)
library (vegan)
library(labdsv)
# Do the k-means clustering [read 'help' for the 'kmeans' function to see what the arguments "centers" (clusters or k) and "nstart" (randomizations) mean].
cluster=4
spe.kmeans_All_WT1 <- kmeans(result0_WT1, centers=cluster, nstart=1500)
spe.kmeans_S1_WT1 <- kmeans(result1_WT1, centers=cluster, nstart=1500)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1500)
spe.kmeans_S3_WT1 <- kmeans(result3_WT1, centers=cluster, nstart=1500)
save.image("WT1_150_K14")
setwd("~/Thymus/Datasets/Data with 11 cell types/WT1_minus/K5")
msz=150  #matrix size in hist2d
#number of clusters produced for K means
txtfiles_WT1=list.files(pattern="*.txt")  #loads in order all files within folder
mat_WT1<-matrix(data=NA,nrow=22500,ncol=30) #this will change with size of matrix and # of sections/cell types
toFill_WT1<-as.data.frame(mat_WT1)  #changes to data frame
toUse0_WT1<-seq(1,30,1) #uses all 33 columns
toUse1_WT1<-seq(1,30,3) #uses columns that correspond to Section1
toUse2_WT1<-seq(2,30,3) #Section2
toUse3_WT1<-seq(3,30,3) #Section3
for(i in toUse0_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse0_WT1]
result_WT1->result0_WT1
}
for(i in toUse1_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse1_WT1]
result_WT1->result1_WT1
}
for(i in toUse2_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse2_WT1]
result_WT1->result2_WT1
}
for(i in toUse3_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse3_WT1]
result_WT1->result3_WT1   ###Section3
}
cluster=4
spe.kmeans_All_WT1 <- kmeans(result0_WT1, centers=cluster, nstart=1500)
spe.kmeans_S1_WT1 <- kmeans(result1_WT1, centers=cluster, nstart=1500)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1500)
spe.kmeans_S3_WT1 <- kmeans(result3_WT1, centers=cluster, nstart=1500)
save.image("WT1_150_K5")
v0_WT1=spe.kmeans_All_WT1$cluster
v1_WT1=spe.kmeans_S1_WT1$cluster
v2_WT1=spe.kmeans_S2_WT1$cluster
v3_WT1=spe.kmeans_S3_WT1$cluster
#load("thymus.Rdata")
#image(v2) # make pic
v0.1_WT1=matrix(v0_WT1,nrow=150,ncol=150)
v1.1_WT1=matrix(v1_WT1,nrow=150,ncol=150)
v2.1_WT1=matrix(v2_WT1,nrow=150,ncol=150)
v3.1_WT1=matrix(v3_WT1,nrow=150,ncol=150)
heatmap.2( v1.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v1.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("yellow", "green", "red", "blue"))
heatmap.2( v3.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v3.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
setwd("~/Thymus/Workspace")
load("WT1_150.rdata")
load("WT1_150_4.rdata")
load("WT1_150.rdata")
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("yellow", "green", "red", "blue"))
setwd("~/Thymus/Datasets/Data with 11 cell types/WT1_minus/K14")
load("WT1_150_K14.rdata")
setwd("~/Thymus/Datasets/Data with 11 cell types/WT1_minus/K14K5")
msz=150  #matrix size in hist2d
#number of clusters produced for K means
txtfiles_WT1=list.files(pattern="*.txt")  #loads in order all files within folder
mat_WT1<-matrix(data=NA,nrow=22500,ncol=30) #this will change with size of matrix and # of sections/cell types
toFill_WT1<-as.data.frame(mat_WT1)  #changes to data frame
toUse0_WT1<-seq(1,30,1) #uses all 33 columns
toUse1_WT1<-seq(1,30,3) #uses columns that correspond to Section1
toUse2_WT1<-seq(2,30,3) #Section2
toUse3_WT1<-seq(3,30,3) #Section3
for(i in toUse0_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse0_WT1]
result_WT1->result0_WT1
}
for(i in toUse1_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse1_WT1]
result_WT1->result1_WT1
}
for(i in toUse2_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse2_WT1]
result_WT1->result2_WT1
}
for(i in toUse3_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse3_WT1]
result_WT1->result3_WT1   ###Section3
}
library (vegan)
library(labdsv)
msz=150  #matrix size in hist2d
#number of clusters produced for K means
txtfiles_WT1=list.files(pattern="*.txt")  #loads in order all files within folder
mat_WT1<-matrix(data=NA,nrow=22500,ncol=30) #this will change with size of matrix and # of sections/cell types
toFill_WT1<-as.data.frame(mat_WT1)  #changes to data frame
toUse0_WT1<-seq(1,30,1) #uses all 33 columns
toUse1_WT1<-seq(1,30,3) #uses columns that correspond to Section1
toUse2_WT1<-seq(2,30,3) #Section2
toUse3_WT1<-seq(3,30,3) #Section3
for(i in toUse0_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse0_WT1]
result_WT1->result0_WT1
}
for(i in toUse1_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse1_WT1]
result_WT1->result1_WT1
}
for(i in toUse2_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse2_WT1]
result_WT1->result2_WT1
}
for(i in toUse3_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse3_WT1]
result_WT1->result3_WT1   ###Section3
}
library (vegan)
library(labdsv)
cluster=4
spe.kmeans_S1_WT1 <- kmeans(result1_WT1, centers=cluster, nstart=1000)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1000)
spe.kmeans_S3_WT1 <- kmeans(result3_WT1, centers=cluster, nstart=1000)
setwd("~/Thymus/Datasets/Data with 11 cell types/WT1_minus/K14K5")
msz=150  #matrix size in hist2d
#number of clusters produced for K means
txtfiles_WT1=list.files(pattern="*.txt")  #loads in order all files within folder
mat_WT1<-matrix(data=NA,nrow=22500,ncol=27) #this will change with size of matrix and # of sections/cell types
toFill_WT1<-as.data.frame(mat_WT1)  #changes to data frame
toUse0_WT1<-seq(1,27,1) #uses all 33 columns
toUse1_WT1<-seq(1,27,3) #uses columns that correspond to Section1
toUse2_WT1<-seq(2,27,3) #Section2
toUse3_WT1<-seq(3,27,3) #Section3
for(i in toUse0_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse0_WT1]
result_WT1->result0_WT1
}
for(i in toUse1_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse1_WT1]
result_WT1->result1_WT1
}
for(i in toUse2_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse2_WT1]
result_WT1->result2_WT1
}
for(i in toUse3_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse3_WT1]
result_WT1->result3_WT1   ###Section3
}
library (vegan)
library(labdsv)
spe.kmeans_S1_WT1 <- kmeans(result1_WT1, centers=cluster, nstart=1000)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1000)
spe.kmeans_S3_WT1 <- kmeans(result3_WT1, centers=cluster, nstart=1000)
cluster=4
spe.kmeans_S1_WT1 <- kmeans(result1_WT1, centers=cluster, nstart=1000)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1000)
spe.kmeans_S3_WT1 <- kmeans(result3_WT1, centers=cluster, nstart=1000)
save.image("WT1_150_4_K5K14.rdata")
v2_WT1=spe.kmeans_S2_WT1$cluster
v2.1_WT1=matrix(v2_WT1,nrow=150,ncol=150)
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("yellow", "green", "red", "blue"))
heatmap.2( v1.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v1.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("blue", "green", "red", "yellow"))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("blue", "yellow", "red", "green))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("blue", "yellow", "red", "green"))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("blue", "yellow", "red", "green"))
heatmap.2( v1.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v1.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
v1_WT1=spe.kmeans_S1_WT1$cluster
v1.1_WT1=matrix(v1_WT1,nrow=150,ncol=150)
heatmap.2( v1.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v1.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
v3_WT1=spe.kmeans_S3_WT1$cluster
heatmap.2( v3.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v3.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
v3_WT1=spe.kmeans_S3_WT1$cluster
v3.1_WT1=matrix(v3_WT1,nrow=150,ncol=150)
heatmap.2( v3.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v3.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "blue", "green"))
setwd("~/Thymus/Datasets/Data with 11 cell types/WT1_minus/K14")
msz=150  #matrix size in hist2d
#number of clusters produced for K means
txtfiles_WT1=list.files(pattern="*.txt")  #loads in order all files within folder
mat_WT1<-matrix(data=NA,nrow=22500,ncol=30) #this will change with size of matrix and # of sections/cell types
toFill_WT1<-as.data.frame(mat_WT1)  #changes to data frame
toUse0_WT1<-seq(1,30,1) #uses all 33 columns
toUse1_WT1<-seq(1,30,3) #uses columns that correspond to Section1
toUse2_WT1<-seq(2,30,3) #Section2
toUse3_WT1<-seq(3,30,3) #Section3
for(i in toUse0_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse0_WT1]
result_WT1->result0_WT1
}
for(i in toUse1_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse1_WT1]
result_WT1->result1_WT1
}
for(i in toUse2_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse2_WT1]
result_WT1->result2_WT1
}
for(i in toUse3_WT1){
tmp_WT1 = read.table(txtfiles_WT1[i], sep="\t", head=T)
X_WT1=tmp_WT1[[1]]  #[,1]
Y_WT1=tmp_WT1[[2]]
my.xy_WT1<-hist2d(X_WT1,Y_WT1,nbins=c(msz,msz))
obj_WT1 <- my.xy_WT1$counts
obj_WT1[1,1] = obj_WT1[1,1]-1
obj_WT1[150,1] = obj_WT1[150,1]-1
obj_WT1[1,150] = obj_WT1[1,150]-1
obj_WT1[150,150]=obj_WT1[150,150]-1
count_WT1<- as.vector(obj_WT1)
toFill_WT1[,i]<-count_WT1
result_WT1<-toFill_WT1[,toUse3_WT1]
result_WT1->result3_WT1   ###Section3
}
library (vegan)
library(labdsv)
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1000)
save.image("WT1_150_K5.rdata")
v2_WT1=spe.kmeans_S2_WT1$cluster
v2.1_WT1=matrix(v2_WT1,nrow=150,ncol=150)
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("blue", "yellow", "red", "green"))
cluster=4
spe.kmeans_S2_WT1 <- kmeans(result2_WT1, centers=cluster, nstart=1000)
v2_WT1=spe.kmeans_S2_WT1$cluster
v2.1_WT1=matrix(v2_WT1,nrow=150,ncol=150)
save.image("WT1_150_K5.rdata")
save.image("WT1_150_K14.rdata")
v2_WT1=spe.kmeans_S2_WT1$cluster
v2.1_WT1=matrix(v2_WT1,nrow=150,ncol=150)
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("blue", "yellow", "red", "green"))
heatmap.2( v2.1_WT1, Rowv=FALSE, Colv=FALSE, dendrogram='none', cellnote=v2.1_WT1,
notecol="black", trace='none', key=FALSE,lwid = c(.01,0.99),lhei = c(.01,.99),
margins = c(0,0),col=c("red", "yellow", "green", "blue"))
