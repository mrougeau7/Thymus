library(SDMTools)
install.packages("SDMTools")
ccl.mat<-ConnCompLabel(my.mat)
library("SDMTools", lib.loc="~/R/win-library/3.1")
ccl.mat<-ConnCompLabel(my.mat)
image(t(ccl.mat[10:1,]),col=c('grey',rainbow(length(unique(ccl.mat))-1)))
max(ccl.mat) #how many clusters
table(ccl.mat) #size distribution
max(ccl.mat) #how many clusters
table(ccl.mat) #size distribution
my.cents<-NULL    #calculate cluster centriods
for (j in 1:max(ccl.mat)){
tmp<-(which(ccl.mat==j,arr.ind=T))
my.cents<-rbind(my.cents,colMeans(tmp))
}
my.cents
library(raster)  #how far apart centroids are from each other
install.packages("raster")
dist.cents<-pointDistance(my.cents,my.cents,lonlat=F,allpairs=T)
library(raster)  #how far apart centroids are from each other
dist.cents<-pointDistance(my.cents,my.cents,lonlat=F,allpairs=T)
dist.cents
mean(dist.cents[which(dist.cents>0)]) #avg distance to other clusters
library(SDMTools)
ccl.mat<-ConnCompLabel(my.mat)
image(t(ccl.mat[10:1,]),col=c('grey',rainbow(length(unique(ccl.mat))-1)))
max(ccl.mat) #how many clusters
table(ccl.mat)
max(ccl.mat) #how many clusters
v0.1_Mutant1
my.mat
ccl.mat<-ConnCompLabel(my.mat)
ccl.mat
View(ccl.mat)
my.cents
my.mat = v1.1_Mutant1
library(SDMTools)
ccl.mat<-ConnCompLabel(my.mat)
image(t(ccl.mat[10:1,]),col=c('grey',rainbow(length(unique(ccl.mat))-1)))
max(ccl.mat) #how many clusters
table(ccl.mat) #size distribution
max(ccl.mat) #how many clusters
load("WT2_150.Rdata")
View(`v0.1_WT2`)
View(`v1.1_WT2`)
my.mat = v1.1_WT2
ccl.mat<-ConnCompLabel(my.mat)
image(t(ccl.mat[10:1,]),col=c('grey',rainbow(length(unique(ccl.mat))-1)))
max(ccl.mat) #how many clusters
mean(dist.cents[which(dist.cents>0)]) #avg distance to other clusters
my.cents<-NULL    #calculate cluster centriods
for (j in 1:max(ccl.mat)){
tmp<-(which(ccl.mat==j,arr.ind=T))
my.cents<-rbind(my.cents,colMeans(tmp))
}
my.cents
library(raster)  #how far apart centroids are from each other
dist.cents<-pointDistance(my.cents,my.cents,lonlat=F,allpairs=T)
dist.cents
mean(dist.cents[which(dist.cents>0)]) #avg distance to other clusters
load("WT1_Rarefaction_150.rdata")
library(vegan)
library(dplyr) # used for chaining and manipulation
# http://blog.rstudio.org/2014/01/17/introducing-dplyr/
#reads as: take only cluster 1 data from 'spe', then take column sums (i.e. total cell type count)
#then transpose (swap rows/cols needed for bray curtis calc)
df_WT1_R<-result0_WT1_R[which(spe.kmeans_All_WT1_R$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT1_R<-result0_WT1_R[which(spe.kmeans_All_WT1_R$cluster==j),] %>% colSums() %>% t()
df_WT1_R<-rbind(df_WT1_R,tmp_WT1_R)
}
df_S1_WT1_R<-result1_WT1_R[which(spe.kmeans_S1_WT1_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT1_R<-result1_WT1_R[which(spe.kmeans_S1_WT1_R$cluster==j),] %>% colSums() %>% t()
df_S1_WT1_R<-rbind(df_S1_WT1_R,tmp_S1_WT1_R)
}
df_S2_WT1_R<-result2_WT1_R[which(spe.kmeans_S2_WT1_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT1_R<-result2_WT1_R[which(spe.kmeans_S2_WT1_R$cluster==j),] %>% colSums() %>% t()
df_S2_WT1_R<-rbind(df_S2_WT1_R,tmp_S2_WT1_R)
}
df_S3_WT1_R<-result3_WT1_R[which(spe.kmeans_S3_WT1_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT1_R<-result3_WT1_R[which(spe.kmeans_S3_WT1_R$cluster==j),] %>% colSums() %>% t()
df_S3_WT1_R<-rbind(df_S3_WT1_R,tmp_S3_WT1_R)
}
#need same number of columns to bind them.
#colnames(df2_WT1_R)<-colnames(df_WT1_R)
colnames(df_S2_WT1_R)=colnames(df_S1_WT1_R)
colnames(df_S3_WT1_R)<-colnames(df_S1_WT1_R)
#df_WT1_R<-apply(df_WT1_R,2,as.integer) %>% as.data.frame()
#df_S1_WT1_R<-apply(df_S1_WT1_R,2,as.integer) %>% as.data.frame()
#df_S2_WT1_R<-apply(df_S2_WT1_R,2,as.integer) %>% as.data.frame()
#df_S3_WT1_R<-apply(df_S3_WT1_R,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_WT1_R,df_S2_WT1_R, df_S3_WT1_R, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_WT1_R, df_S2_WT1_R, df_S3_Mutant3)
dfT_WT1_R=rbind(df_S1_WT1_R,df_S2_WT1_R,df_S3_WT1_R)
BrayCurtis_WT1_R<-vegdist(dfT_WT1_R,method="bray")
#print(BrayCurtis)
hc_WT1_R<-hclust(BrayCurtis_WT1_R)
#plot(hc_WT1_R,labels=dfT$rownames)
plot(hc_WT1_R)
save.image("WT1_Rarefaction_150.rdata")
BrayCurtis_WT1_R
load("Mutant1_150.rdata")
plot(hc_Mutant1)
BrayCurtis_Mutant1
load("Mutant1.rdata")
df_Mutant1<-result0_Mutant1[which(spe.kmeans_All_Mutant1$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_Mutant1<-result0_Mutant1[which(spe.kmeans_All_Mutant1$cluster==j),] %>% colSums() %>% t()
df_Mutant1<-rbind(df_Mutant1,tmp_Mutant1)
}
df_S1_Mutant1<-result1_Mutant1[which(spe.kmeans_S1_Mutant1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_Mutant1<-result1_Mutant1[which(spe.kmeans_S1_Mutant1$cluster==j),] %>% colSums() %>% t()
df_S1_Mutant1<-rbind(df_S1_Mutant1,tmp_S1_Mutant1)
}
df_S2_Mutant1<-result2_Mutant1[which(spe.kmeans_S2_Mutant1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_Mutant1<-result2_Mutant1[which(spe.kmeans_S2_Mutant1$cluster==j),] %>% colSums() %>% t()
df_S2_Mutant1<-rbind(df_S2_Mutant1,tmp_S2_Mutant1)
}
df_S3_Mutant1<-result3_Mutant1[which(spe.kmeans_S3_Mutant1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_Mutant1<-result3_Mutant1[which(spe.kmeans_S3_Mutant1$cluster==j),] %>% colSums() %>% t()
df_S3_Mutant1<-rbind(df_S3_Mutant1,tmp_S3_Mutant1)
}
#need same number of columns to bind them.
#colnames(df2_Mutant1)<-colnames(df_Mutant1)
colnames(df_S2_Mutant1)=colnames(df_S1_Mutant1)
colnames(df_S3_Mutant1)<-colnames(df_S1_Mutant1)
#df_Mutant1<-apply(df_Mutant1,2,as.integer) %>% as.data.frame()
#df_S1_Mutant1<-apply(df_S1_Mutant1,2,as.integer) %>% as.data.frame()
#df_S2_Mutant1<-apply(df_S2_Mutant1,2,as.integer) %>% as.data.frame()
#df_S3_Mutant1<-apply(df_S3_Mutant1,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_Mutant1,df_S2_Mutant1, df_S3_Mutant1, df_S1_Mutant1, df_S2_Mutant1, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_Mutant1, df_S2_Mutant1, df_S3_Mutant3)
dfT_Mutant1=rbind(df_S1_Mutant1,df_S2_Mutant1,df_S3_Mutant1)
BrayCurtis_Mutant1<-vegdist(dfT_Mutant1,method="bray")
#print(BrayCurtis)
hc_Mutant1<-hclust(BrayCurtis_Mutant1)
#plot(hc,labels=dfT$rownames)
plot(hc_Mutant1)
save.image("Mutant1.rdata")
View(tmp_S1_Mutant1)
load("Mutant1_Rarefaction_150.rdata")
df_Mutant1_R<-result0_Mutant1_R[which(spe.kmeans_All_Mutant1_R$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_Mutant1_R<-result0_Mutant1_R[which(spe.kmeans_All_Mutant1_R$cluster==j),] %>% colSums() %>% t()
df_Mutant1_R<-rbind(df_Mutant1_R,tmp_Mutant1_R)
}
df_S1_Mutant1_R<-result1_Mutant1_R[which(spe.kmeans_S1_Mutant1_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_Mutant1_R<-result1_Mutant1_R[which(spe.kmeans_S1_Mutant1_R$cluster==j),] %>% colSums() %>% t()
df_S1_Mutant1_R<-rbind(df_S1_Mutant1_R,tmp_S1_Mutant1_R)
}
df_S2_Mutant1_R<-result2_Mutant1_R[which(spe.kmeans_S2_Mutant1_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_Mutant1_R<-result2_Mutant1_R[which(spe.kmeans_S2_Mutant1_R$cluster==j),] %>% colSums() %>% t()
df_S2_Mutant1_R<-rbind(df_S2_Mutant1_R,tmp_S2_Mutant1_R)
}
df_S3_Mutant1_R<-result3_Mutant1_R[which(spe.kmeans_S3_Mutant1_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_Mutant1_R<-result3_Mutant1_R[which(spe.kmeans_S3_Mutant1_R$cluster==j),] %>% colSums() %>% t()
df_S3_Mutant1_R<-rbind(df_S3_Mutant1_R,tmp_S3_Mutant1_R)
}
#need same number of columns to bind them.
#colnames(df2_Mutant1_R)<-colnames(df_Mutant1_R)
colnames(df_S2_Mutant1_R)=colnames(df_S1_Mutant1_R)
colnames(df_S3_Mutant1_R)<-colnames(df_S1_Mutant1_R)
#df_Mutant1_R<-apply(df_Mutant1_R,2,as.integer) %>% as.data.frame()
#df_S1_Mutant1_R<-apply(df_S1_Mutant1_R,2,as.integer) %>% as.data.frame()
#df_S2_Mutant1_R<-apply(df_S2_Mutant1_R,2,as.integer) %>% as.data.frame()
#df_S3_Mutant1_R<-apply(df_S3_Mutant1_R,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_Mutant1_R,df_S2_Mutant1_R, df_S3_Mutant1_R, df_S1_Mutant1_R, df_S2_Mutant1_R, df_S3_WT3, df_S1_Mutant1_R,
#df_S2_Mutant1_R, df_S3_Mutant1_R, df_S1_Mutant1_R, df_S2_Mutant1_R, df_S3_Mutant3)
dfT_Mutant1_R=rbind(df_S1_Mutant1_R,df_S2_Mutant1_R,df_S3_Mutant1_R)
BrayCurtis_Mutant1_R<-vegdist(dfT_Mutant1_R,method="bray")
#print(BrayCurtis)
hc_Mutant1_R<-hclust(BrayCurtis_Mutant1_R)
#plot(hc,labels=dfT$rownames)
plot(hc_Mutant1_R)
save.image("Mutant1_Rarefaction_150.rdata")
load("Mutant2.rdata")
df_Mutant2<-result0_Mutant2[which(spe.kmeans_All_Mutant2$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_Mutant2<-result0_Mutant2[which(spe.kmeans_All_Mutant2$cluster==j),] %>% colSums() %>% t()
df_Mutant2<-rbind(df_Mutant2,tmp_Mutant2)
}
df_S1_Mutant2<-result1_Mutant2[which(spe.kmeans_S1_Mutant2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_Mutant2<-result1_Mutant2[which(spe.kmeans_S1_Mutant2$cluster==j),] %>% colSums() %>% t()
df_S1_Mutant2<-rbind(df_S1_Mutant2,tmp_S1_Mutant2)
}
df_S2_Mutant2<-result2_Mutant2[which(spe.kmeans_S2_Mutant2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_Mutant2<-result2_Mutant2[which(spe.kmeans_S2_Mutant2$cluster==j),] %>% colSums() %>% t()
df_S2_Mutant2<-rbind(df_S2_Mutant2,tmp_S2_Mutant2)
}
df_S3_Mutant2<-result3_Mutant2[which(spe.kmeans_S3_Mutant2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_Mutant2<-result3_Mutant2[which(spe.kmeans_S3_Mutant2$cluster==j),] %>% colSums() %>% t()
df_S3_Mutant2<-rbind(df_S3_Mutant2,tmp_S3_Mutant2)
}
#need same number of columns to bind them.
#colnames(df2_Mutant2)<-colnames(df_Mutant2)
colnames(df_S2_Mutant2)=colnames(df_S1_Mutant2)
colnames(df_S3_Mutant2)<-colnames(df_S1_Mutant2)
#df_Mutant2<-apply(df_Mutant2,2,as.integer) %>% as.data.frame()
#df_S1_Mutant2<-apply(df_S1_Mutant2,2,as.integer) %>% as.data.frame()
#df_S2_Mutant2<-apply(df_S2_Mutant2,2,as.integer) %>% as.data.frame()
#df_S3_Mutant2<-apply(df_S3_Mutant2,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_Mutant2,df_S2_Mutant2, df_S3_Mutant2, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_Mutant2, df_S2_Mutant2, df_S3_Mutant3)
dfT_Mutant2=rbind(df_S1_Mutant2,df_S2_Mutant2,df_S3_Mutant2)
BrayCurtis_Mutant2<-vegdist(dfT_Mutant2,method="bray")
#print(BrayCurtis)
hc_Mutant2<-hclust(BrayCurtis_Mutant2)
#plot(hc,labels=dfT$rownames)
plot(hc_Mutant2)
save.image("Mutant2_150.rdata")
save.image("Mutant2.rdata")
load("Mutant2_R_Rarefaction_150.rdata")
load("Mutant2_Rarefaction_150.rdata")
df_Mutant2_R<-result0_Mutant2_R[which(spe.kmeans_All_Mutant2_R$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_Mutant2_R<-result0_Mutant2_R[which(spe.kmeans_All_Mutant2_R$cluster==j),] %>% colSums() %>% t()
df_Mutant2_R<-rbind(df_Mutant2_R,tmp_Mutant2_R)
}
df_S1_Mutant2_R<-result1_Mutant2_R[which(spe.kmeans_S1_Mutant2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_Mutant2_R<-result1_Mutant2_R[which(spe.kmeans_S1_Mutant2_R$cluster==j),] %>% colSums() %>% t()
df_S1_Mutant2_R<-rbind(df_S1_Mutant2_R,tmp_S1_Mutant2_R)
}
df_S2_Mutant2_R<-result2_Mutant2_R[which(spe.kmeans_S2_Mutant2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_Mutant2_R<-result2_Mutant2_R[which(spe.kmeans_S2_Mutant2_R$cluster==j),] %>% colSums() %>% t()
df_S2_Mutant2_R<-rbind(df_S2_Mutant2_R,tmp_S2_Mutant2_R)
}
df_S3_Mutant2_R<-result3_Mutant2_R[which(spe.kmeans_S3_Mutant2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_Mutant2_R<-result3_Mutant2_R[which(spe.kmeans_S3_Mutant2_R$cluster==j),] %>% colSums() %>% t()
df_S3_Mutant2_R<-rbind(df_S3_Mutant2_R,tmp_S3_Mutant2_R)
}
colnames(df_S2_Mutant2_R)=colnames(df_S1_Mutant2_R)
colnames(df_S3_Mutant2_R)<-colnames(df_S1_Mutant2_R)
#df_Mutant2_R<-apply(df_Mutant2_R,2,as.integer) %>% as.data.frame()
#df_S1_Mutant2_R<-apply(df_S1_Mutant2_R,2,as.integer) %>% as.data.frame()
#df_S2_Mutant2_R<-apply(df_S2_Mutant2_R,2,as.integer) %>% as.data.frame()
#df_S3_Mutant2_R<-apply(df_S3_Mutant2_R,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_Mutant2_R,df_S2_Mutant2_R, df_S3_Mutant2_R, df_S1_Mutant2_R, df_S2_Mutant2_R, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_Mutant2_R, df_S2_Mutant2_R, df_S3_Mutant3)
dfT_Mutant2_R=rbind(df_S1_Mutant2_R,df_S2_Mutant2_R,df_S3_Mutant2_R)
BrayCurtis_Mutant2_R<-vegdist(dfT_Mutant2_R,method="bray")
#print(BrayCurtis)
hc_Mutant2_R<-hclust(BrayCurtis_Mutant2_R)
#plot(hc,labels=dfT$rownames)
plot(hc_Mutant2_R)
save.image("Mutant2_Rarefaction_150.rdata")
BrayCurtis_Mutant2_R
load("WT1.rdata")
df_WT1<-result0_WT1[which(spe.kmeans_All_WT1$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT1<-result0_WT1[which(spe.kmeans_All_WT1$cluster==j),] %>% colSums() %>% t()
df_WT1<-rbind(df_WT1,tmp_WT1)
}
df_S1_WT1<-result1_WT1[which(spe.kmeans_S1_WT1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT1<-result1_WT1[which(spe.kmeans_S1_WT1$cluster==j),] %>% colSums() %>% t()
df_S1_WT1<-rbind(df_S1_WT1,tmp_S1_WT1)
}
df_S2_WT1<-result2_WT1[which(spe.kmeans_S2_WT1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT1<-result2_WT1[which(spe.kmeans_S2_WT1$cluster==j),] %>% colSums() %>% t()
df_S2_WT1<-rbind(df_S2_WT1,tmp_S2_WT1)
}
df_S3_WT1<-result3_WT1[which(spe.kmeans_S3_WT1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT1<-result3_WT1[which(spe.kmeans_S3_WT1$cluster==j),] %>% colSums() %>% t()
df_S3_WT1<-rbind(df_S3_WT1,tmp_S3_WT1)
}
colnames(df_S2_WT1)=colnames(df_S1_WT1)
colnames(df_S3_WT1)<-colnames(df_S1_WT1)
#df_WT1<-apply(df_WT1,2,as.integer) %>% as.data.frame()
#df_S1_WT1<-apply(df_S1_WT1,2,as.integer) %>% as.data.frame()
#df_S2_WT1<-apply(df_S2_WT1,2,as.integer) %>% as.data.frame()
#df_S3_WT1<-apply(df_S3_WT1,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_WT1,df_S2_WT1, df_S3_WT1, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_WT1, df_S2_WT1, df_S3_Mutant3)
dfT_WT1=rbind(df_S1_WT1,df_S2_WT1,df_S3_WT1)
BrayCurtis_WT1<-vegdist(dfT_WT1,method="bray")
#print(BrayCurtis)
hc_WT1<-hclust(BrayCurtis_WT1)
save.image("WT1.rdata")
plot(hc_WT1)
load("WT1_150.rdata")
df_WT1<-result0_WT1[which(spe.kmeans_All_WT1$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT1<-result0_WT1[which(spe.kmeans_All_WT1$cluster==j),] %>% colSums() %>% t()
df_WT1<-rbind(df_WT1,tmp_WT1)
}
df_S1_WT1<-result1_WT1[which(spe.kmeans_S1_WT1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT1<-result1_WT1[which(spe.kmeans_S1_WT1$cluster==j),] %>% colSums() %>% t()
df_S1_WT1<-rbind(df_S1_WT1,tmp_S1_WT1)
}
df_S2_WT1<-result2_WT1[which(spe.kmeans_S2_WT1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT1<-result2_WT1[which(spe.kmeans_S2_WT1$cluster==j),] %>% colSums() %>% t()
df_S2_WT1<-rbind(df_S2_WT1,tmp_S2_WT1)
}
df_S3_WT1<-result3_WT1[which(spe.kmeans_S3_WT1$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT1<-result3_WT1[which(spe.kmeans_S3_WT1$cluster==j),] %>% colSums() %>% t()
df_S3_WT1<-rbind(df_S3_WT1,tmp_S3_WT1)
}
#need same number of columns to bind them.
#colnames(df2_WT1)<-colnames(df_WT1)
colnames(df_S2_WT1)=colnames(df_S1_WT1)
colnames(df_S3_WT1)<-colnames(df_S1_WT1)
#df_WT1<-apply(df_WT1,2,as.integer) %>% as.data.frame()
#df_S1_WT1<-apply(df_S1_WT1,2,as.integer) %>% as.data.frame()
#df_S2_WT1<-apply(df_S2_WT1,2,as.integer) %>% as.data.frame()
#df_S3_WT1<-apply(df_S3_WT1,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_WT1,df_S2_WT1, df_S3_WT1, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_WT1, df_S2_WT1, df_S3_Mutant3)
dfT_WT1=rbind(df_S1_WT1,df_S2_WT1,df_S3_WT1)
BrayCurtis_WT1<-vegdist(dfT_WT1,method="bray")
#print(BrayCurtis)
hc_WT1<-hclust(BrayCurtis_WT1)
#plot(hc,labels=dfT$rownames)
plot(hc_WT1)
save.image("WT1_150.rdata")
BrayCurtis_WT1
load("WT2.rdata")
df_WT2<-result0_WT2[which(spe.kmeans_All_WT2$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT2<-result0_WT2[which(spe.kmeans_All_WT2$cluster==j),] %>% colSums() %>% t()
df_WT2<-rbind(df_WT2,tmp_WT2)
}
df_S1_WT2<-result1_WT2[which(spe.kmeans_S1_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT2<-result1_WT2[which(spe.kmeans_S1_WT2$cluster==j),] %>% colSums() %>% t()
df_S1_WT2<-rbind(df_S1_WT2,tmp_S1_WT2)
}
df_S2_WT2<-result2_WT2[which(spe.kmeans_S2_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT2<-result2_WT2[which(spe.kmeans_S2_WT2$cluster==j),] %>% colSums() %>% t()
df_S2_WT2<-rbind(df_S2_WT2,tmp_S2_WT2)
}
df_S3_WT2<-result3_WT2[which(spe.kmeans_S3_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT2<-result3_WT2[which(spe.kmeans_S3_WT2$cluster==j),] %>% colSums() %>% t()
df_S3_WT2<-rbind(df_S3_WT2,tmp_S3_WT2)
}
#need same number of columns to bind them.
#colnames(df2_WT2)<-colnames(df_WT2)
colnames(df_S2_WT2)=colnames(df_S1_WT2)
colnames(df_S3_WT2)<-colnames(df_S1_WT2)
#df_WT2<-apply(df_WT2,2,as.integer) %>% as.data.frame()
#df_S1_WT2<-apply(df_S1_WT2,2,as.integer) %>% as.data.frame()
#df_S2_WT2<-apply(df_S2_WT2,2,as.integer) %>% as.data.frame()
#df_S3_WT2<-apply(df_S3_WT2,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_WT2,df_S2_WT2, df_S3_WT2, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_WT2, df_S2_WT2, df_S3_Mutant3)
dfT_WT2=rbind(df_S1_WT2,df_S2_WT2,df_S3_WT2)
BrayCurtis_WT2<-vegdist(dfT_WT2,method="bray")
#print(BrayCurtis)
hc_WT2<-hclust(BrayCurtis_WT2)
#plot(hc,labels=dfT$rownames)
plot(hc_WT2)
save.image("WT2.rdata")
load("WT2_100.rdata")
df_WT2<-result0_WT2[which(spe.kmeans_All_WT2$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT2<-result0_WT2[which(spe.kmeans_All_WT2$cluster==j),] %>% colSums() %>% t()
df_WT2<-rbind(df_WT2,tmp_WT2)
}
df_S1_WT2<-result1_WT2[which(spe.kmeans_S1_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT2<-result1_WT2[which(spe.kmeans_S1_WT2$cluster==j),] %>% colSums() %>% t()
df_S1_WT2<-rbind(df_S1_WT2,tmp_S1_WT2)
}
df_S2_WT2<-result2_WT2[which(spe.kmeans_S2_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT2<-result2_WT2[which(spe.kmeans_S2_WT2$cluster==j),] %>% colSums() %>% t()
df_S2_WT2<-rbind(df_S2_WT2,tmp_S2_WT2)
}
df_S3_WT2<-result3_WT2[which(spe.kmeans_S3_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT2<-result3_WT2[which(spe.kmeans_S3_WT2$cluster==j),] %>% colSums() %>% t()
df_S3_WT2<-rbind(df_S3_WT2,tmp_S3_WT2)
}
#need same number of columns to bind them.
#colnames(df2_WT2)<-colnames(df_WT2)
colnames(df_S2_WT2)=colnames(df_S1_WT2)
colnames(df_S3_WT2)<-colnames(df_S1_WT2)
#df_WT2<-apply(df_WT2,2,as.integer) %>% as.data.frame()
#df_S1_WT2<-apply(df_S1_WT2,2,as.integer) %>% as.data.frame()
#df_S2_WT2<-apply(df_S2_WT2,2,as.integer) %>% as.data.frame()
#df_S3_WT2<-apply(df_S3_WT2,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_WT2,df_S2_WT2, df_S3_WT2, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_WT2, df_S2_WT2, df_S3_Mutant3)
dfT_WT2=rbind(df_S1_WT2,df_S2_WT2,df_S3_WT2)
BrayCurtis_WT2<-vegdist(dfT_WT2,method="bray")
#print(BrayCurtis)
hc_WT2<-hclust(BrayCurtis_WT2)
#plot(hc,labels=dfT$rownames)
plot(hc_WT2)
save.image("WT2_100.rdata")
load("WT2_150.rdata")
df_WT2<-result0_WT2[which(spe.kmeans_All_WT2$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT2<-result0_WT2[which(spe.kmeans_All_WT2$cluster==j),] %>% colSums() %>% t()
df_WT2<-rbind(df_WT2,tmp_WT2)
}
df_S1_WT2<-result1_WT2[which(spe.kmeans_S1_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT2<-result1_WT2[which(spe.kmeans_S1_WT2$cluster==j),] %>% colSums() %>% t()
df_S1_WT2<-rbind(df_S1_WT2,tmp_S1_WT2)
}
df_S2_WT2<-result2_WT2[which(spe.kmeans_S2_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT2<-result2_WT2[which(spe.kmeans_S2_WT2$cluster==j),] %>% colSums() %>% t()
df_S2_WT2<-rbind(df_S2_WT2,tmp_S2_WT2)
}
df_S3_WT2<-result3_WT2[which(spe.kmeans_S3_WT2$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT2<-result3_WT2[which(spe.kmeans_S3_WT2$cluster==j),] %>% colSums() %>% t()
df_S3_WT2<-rbind(df_S3_WT2,tmp_S3_WT2)
}
#need same number of columns to bind them.
#colnames(df2_WT2)<-colnames(df_WT2)
colnames(df_S2_WT2)=colnames(df_S1_WT2)
colnames(df_S3_WT2)<-colnames(df_S1_WT2)
#df_WT2<-apply(df_WT2,2,as.integer) %>% as.data.frame()
#df_S1_WT2<-apply(df_S1_WT2,2,as.integer) %>% as.data.frame()
#df_S2_WT2<-apply(df_S2_WT2,2,as.integer) %>% as.data.frame()
#df_S3_WT2<-apply(df_S3_WT2,2,as.integer) %>% as.data.frame()
#dfTOTAL<-rbind(df_S1_WT2,df_S2_WT2, df_S3_WT2, df_S1_WT2, df_S2_WT2, df_S3_WT3, df_S1_Mutant1,
#df_S2_Mutant1, df_S3_Mutant1, df_S1_WT2, df_S2_WT2, df_S3_Mutant3)
dfT_WT2=rbind(df_S1_WT2,df_S2_WT2,df_S3_WT2)
BrayCurtis_WT2<-vegdist(dfT_WT2,method="bray")
#print(BrayCurtis)
hc_WT2<-hclust(BrayCurtis_WT2)
#plot(hc,labels=dfT$rownames)
plot(hc_WT2)
save.image("WT2_150.rdata")
load("WT2_Rarefaction_150.rdata")
df_WT2_R<-result0_WT2_R[which(spe.kmeans_All_WT2_R$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT2_R<-result0_WT2_R[which(spe.kmeans_All_WT2_R$cluster==j),] %>% colSums() %>% t()
df_WT2_R<-rbind(df_WT2_R,tmp_WT2_R)
}
df_S2_WT2_R<-result1_WT2_R[which(spe.kmeans_S2_WT2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT2_R<-result1_WT2_R[which(spe.kmeans_S2_WT2_R$cluster==j),] %>% colSums() %>% t()
df_S2_WT2_R<-rbind(df_S2_WT2_R,tmp_S2_WT2_R)
}
df_S2_WT2_R<-result2_WT2_R[which(spe.kmeans_S1_WT2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT2_R<-result2_WT2_R[which(spe.kmeans_S1_WT2_R$cluster==j),] %>% colSums() %>% t()
df_S1_WT2_R<-rbind(df_S1_WT2_R,tmp_S1_WT2_R)
}
df_S3_WT2_R<-result3_WT2_R[which(spe.kmeans_S3_WT2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT2_R<-result3_WT2_R[which(spe.kmeans_S3_WT2_R$cluster==j),] %>% colSums() %>% t()
df_S3_WT2_R<-rbind(df_S3_WT2_R,tmp_S3_WT2_R)
}
colnames(df_S2_WT2_R)=colnames(df_S1_WT2_R)
colnames(df_S3_WT2_R)<-colnames(df_S1_WT2_R)
dfT_WT2_R=rbind(df_S1_WT2_R,df_S2_WT2_R,df_S3_WT2_R)
BrayCurtis_WT2_R<-vegdist(dfT_WT2_R,method="bray")
#print(BrayCurtis)
hc_WT2_R<-hclust(BrayCurtis_WT2_R)
#plot(hc,labels=dfT$rownames)
plot(hc_WT2_R)
save.image("WT2_Rarefaction_150.rdata")
BrayCurtis_WT2_R
df_WT2_R<-result0_WT2_R[which(spe.kmeans_All_WT2_R$cluster==1),] %>% colSums() %>% t()   # example of chaining.
for (j in 2:4){
tmp_WT2_R<-result0_WT2_R[which(spe.kmeans_All_WT2_R$cluster==j),] %>% colSums() %>% t()
df_WT2_R<-rbind(df_WT2_R,tmp_WT2_R)
}
df_S1_WT2_R<-result1_WT2_R[which(spe.kmeans_S1_WT2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S1_WT2_R<-result1_WT2_R[which(spe.kmeans_S1_WT2_R$cluster==j),] %>% colSums() %>% t()
df_S1_WT2_R<-rbind(df_S1_WT2_R,tmp_S1_WT2_R)
}
df_S2_WT2_R<-result2_WT2_R[which(spe.kmeans_S2_WT2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S2_WT2_R<-result2_WT2_R[which(spe.kmeans_S2_WT2_R$cluster==j),] %>% colSums() %>% t()
df_S2_WT2_R<-rbind(df_S2_WT2_R,tmp_S2_WT2_R)
}
df_S3_WT2_R<-result3_WT2_R[which(spe.kmeans_S3_WT2_R$cluster==1),] %>% colSums() %>% t()
for (j in 2:4){
tmp_S3_WT2_R<-result3_WT2_R[which(spe.kmeans_S3_WT2_R$cluster==j),] %>% colSums() %>% t()
df_S3_WT2_R<-rbind(df_S3_WT2_R,tmp_S3_WT2_R)
}
colnames(df_S2_WT2_R)=colnames(df_S1_WT2_R)
colnames(df_S3_WT2_R)<-colnames(df_S1_WT2_R)
dfT_WT2_R=rbind(df_S1_WT2_R,df_S2_WT2_R,df_S3_WT2_R)
BrayCurtis_WT2_R<-vegdist(dfT_WT2_R,method="bray")
#print(BrayCurtis)
plot(hc_WT2_R)
BrayCurtis_WT2_R
plot(hc_WT2_R)
hc_WT2_R<-hclust(BrayCurtis_WT2_R)
#plot(hc,labels=dfT$rownames)
plot(hc_WT2_R)
save.image("WT2_Rarefaction_150.rdata")
